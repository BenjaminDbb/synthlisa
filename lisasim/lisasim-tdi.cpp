/* $Id$
 * $Date$
 * $Author$
 * $Revision$
 */

#include "lisasim-tdi.h"

double TDI::X(double t) {
    return( y(1, 3, 2, 3, 2, 2, t) -
            y(1, 2, 3, 2, 3, 3, t) +
            y(2, 3, 1, 2, 2, 0, t) -
            y(3, 2, 1, 3, 3, 0, t) +
            y(1, 2, 3, 2, 0, 0, t) -
            y(1, 3, 2, 3, 0, 0, t) + 
            y(3, 2, 1, 0, 0, 0, t) -
            y(2, 3, 1, 0, 0, 0, t) +
    0.5 * (-z(3, 2, 1, 2, 2, 3, 3, t) +
            z(3, 2, 1, 3, 3, 0, 0, t) +
            z(3, 2, 1, 2, 2, 0, 0, t) -
            z(3, 2, 1, 0, 0, 0, 0, t) ) +
    0.5 * ( z(2, 3, 1, 2, 2, 3, 3, t) -
            z(2, 3, 1, 3, 3, 0, 0, t) -
            z(2, 3, 1, 2, 2, 0, 0, t) +
            z(2, 3, 1, 0, 0, 0, 0, t) ) );
}

double TDI::Y(double t) {
    return( y(2, 1, 3, 1, 3, 3, t) -
            y(2, 3, 1, 3, 1, 1, t) +
            y(3, 1, 2, 3, 3, 0, t) -
            y(1, 3, 2, 1, 1, 0, t) +
            y(2, 3, 1, 3, 0, 0, t) -
            y(2, 1, 3, 1, 0, 0, t) + 
            y(1, 3, 2, 0, 0, 0, t) -
            y(3, 1, 2, 0, 0, 0, t) + 
    0.5 * (-z(1, 3, 2, 3, 3, 1, 1, t) +
            z(1, 3, 2, 1, 1, 0, 0, t) +
            z(1, 3, 2, 3, 3, 0, 0, t) -
            z(1, 3, 2, 0, 0, 0, 0, t) ) +
    0.5 * ( z(3, 1, 2, 3, 3, 1, 1, t) -
            z(3, 1, 2, 1, 1, 0, 0, t) -
            z(3, 1, 2, 3, 3, 0, 0, t) +
            z(3, 1, 2, 0, 0, 0, 0, t) ) );
}

double TDI::Z(double t) {
    return( y(3, 2, 1, 2, 1, 1, t) -
            y(3, 1, 2, 1, 2, 2, t) +
            y(1, 2, 3, 1, 1, 0, t) -
            y(2, 1, 3, 2, 2, 0, t) +
            y(3, 1, 2, 1, 0, 0, t) -
            y(3, 2, 1, 2, 0, 0, t) + 
            y(2, 1, 3, 0, 0, 0, t) -
            y(1, 2, 3, 0, 0, 0, t) +
    0.5 * (-z(2, 1, 3, 1, 1, 2, 2, t) +
            z(2, 1, 3, 2, 2, 0, 0, t) +
            z(2, 1, 3, 1, 1, 0, 0, t) -
            z(2, 1, 3, 0, 0, 0, 0, t) ) +
    0.5 * ( z(1, 2, 3, 1, 1, 2, 2, t) -
            z(1, 2, 3, 2, 2, 0, 0, t) -
            z(1, 2, 3, 1, 1, 0, 0, t) +
            z(1, 2, 3, 0, 0, 0, 0, t) ) );
}

double TDI::alpha(double t) {
    return( y(3, 2, 1, 0, 0, 0, t) -
            y(2, 3, 1, 0, 0, 0, t) +
            y(2, 1, 3, 2, 0, 0, t) -
            y(3, 1, 2, 3, 0, 0, t) +
            y(1, 3, 2, 1, 2, 0, t) -
            y(1, 2, 3, 1, 3, 0, t) -
    0.5 * ( z(2, 1, 3, 2, 0, 0, 0, t) +
            z(2, 1, 3, 1, 3, 0, 0, t) +
            z(3, 2, 1, 0, 0, 0, 0, t) +
            z(3, 2, 1, 1, 2, 3, 0, t) +
            z(1, 3, 2, 3, 0, 0, 0, t) +
            z(1, 3, 2, 1, 2, 0, 0, t) ) +
    0.5 * ( z(1, 2, 3, 2, 0, 0, 0, t) +
            z(1, 2, 3, 1, 3, 0, 0, t) +
            z(2, 3, 1, 0, 0, 0, 0, t) +
            z(2, 3, 1, 1, 2, 3, 0, t) + 
            z(3, 1, 2, 3, 0, 0, 0, t) +
            z(3, 1, 2, 1, 2, 0, 0, t) ) );
}

double TDI::beta(double t) {
    return( y(1, 3, 2, 0, 0, 0, t) -
            y(3, 1, 2, 0, 0, 0, t) +
            y(3, 2, 1, 3, 0, 0, t) -
            y(1, 2, 3, 1, 0, 0, t) +
            y(2, 1, 3, 2, 3, 0, t) -
            y(2, 3, 1, 2, 1, 0, t) -
    0.5 * ( z(3, 2, 1, 3, 0, 0, 0, t) +
            z(3, 2, 1, 2, 1, 0, 0, t) +
            z(1, 3, 2, 0, 0, 0, 0, t) +
            z(1, 3, 2, 2, 3, 1, 0, t) +
            z(2, 1, 3, 1, 0, 0, 0, t) +
            z(2, 1, 3, 2, 3, 0, 0, t) ) +
    0.5 * ( z(2, 3, 1, 3, 0, 0, 0, t) +
            z(2, 3, 1, 2, 1, 0, 0, t) +
            z(3, 1, 2, 0, 0, 0, 0, t) +
            z(3, 1, 2, 2, 3, 1, 0, t) + 
            z(1, 2, 3, 1, 0, 0, 0, t) +
            z(1, 2, 3, 2, 3, 0, 0, t) ) );
}

double TDI::gamma(double t) {
    return( y(2, 1, 3, 0, 0, 0, t) -
            y(1, 2, 3, 0, 0, 0, t) +
            y(1, 3, 2, 1, 0, 0, t) -
            y(2, 3, 1, 2, 0, 0, t) +
            y(3, 2, 1, 3, 1, 0, t) -
            y(3, 1, 2, 3, 2, 0, t) -
    0.5 * ( z(1, 3, 2, 1, 0, 0, 0, t) +
            z(1, 3, 2, 3, 2, 0, 0, t) +
            z(2, 1, 3, 0, 0, 0, 0, t) +
            z(2, 1, 3, 3, 1, 2, 0, t) +
            z(3, 2, 1, 2, 0, 0, 0, t) +
            z(3, 2, 1, 3, 1, 0, 0, t) ) +
    0.5 * ( z(3, 1, 2, 1, 0, 0, 0, t) +
            z(3, 1, 2, 3, 2, 0, 0, t) +
            z(1, 2, 3, 0, 0, 0, 0, t) +
            z(1, 2, 3, 3, 1, 2, 0, t) + 
            z(2, 3, 1, 2, 0, 0, 0, t) +
            z(2, 3, 1, 3, 1, 0, 0, t) ) );
}

double TDI::zeta(double t) {
    return( y(1, 3, 2, 2, 0, 0, t) -
            y(1, 2, 3, 3, 0, 0, t) +
            y(2, 1, 3, 3, 0, 0, t) -
            y(2, 3, 1, 1, 0, 0, t) +
            y(3, 2, 1, 1, 0, 0, t) -
            y(3, 1, 2, 2, 0, 0, t) +
    0.5 * (-z(2, 1, 3, 2, 1, 0, 0, t) +
            z(1, 2, 3, 1, 2, 0, 0, t) -
            z(3, 2, 1, 2, 3, 0, 0, t) +
            z(2, 3, 1, 2, 3, 0, 0, t) -
            z(1, 3, 2, 1, 3, 0, 0, t) +
            z(3, 1, 2, 1, 3, 0, 0, t) ) +
    0.5 * (-z(1, 3, 2, 2, 0, 0, 0, t) +
            z(3, 1, 2, 2, 0, 0, 0, t) -
            z(2, 1, 3, 3, 0, 0, 0, t) +
            z(1, 2, 3, 3, 0, 0, 0, t) -
            z(3, 2, 1, 1, 0, 0, 0, t) +
            z(2, 3, 1, 1, 0, 0, 0, t) ) );
}

double TDI::zeta1(double t) {
    return( ( y(3,-2, 1, 1, 2, 3, t) -
              y(3, 1, 2,-2, 2, 3, t) +
              y(1,-3, 2,-2, 2, 3, t) ) -
            ( y(1, 2, 3, 3,-3,-2, t) -
              y(2,-1, 3, 3,-3,-2, t) +
              y(2, 3, 1,-1,-3,-2, t) ) -
            ( y(3,-2, 1, 1,-1, 0, t) -
              y(3, 1, 2,-2,-1, 0, t) +
              y(1,-3, 2,-2,-1, 0, t) ) +
            ( y(1, 2, 3, 3, 1, 0, t) -
              y(2,-1, 3, 3, 1, 0, t) +
              y(2, 3, 1,-1, 1, 0, t) ) +
      0.5*( ( z(3, 1, 2,-2, 2, 3, 0, t) -
              z(1,-3, 2,-2, 2, 3, 0, t)   ) -
            ( z(3, 1, 2,-2,-1, 0, 0, t) -
              z(1,-3, 2,-2,-1, 0, 0, t)   ) +
            ( z(3, 1, 2,-1, 3,-3,-2, t) -
              z(1,-3, 2,-1, 3,-3,-2, t)   ) -
            ( z(3, 1, 2,-1, 3, 1, 0, t) -
              z(1,-3, 2,-1, 3, 1, 0, t)   ) +
            ( z(1, 2, 3,-2, 2, 3, 1, t) -
              z(2,-1, 3,-2, 2, 3, 1, t)   ) -
            ( z(1, 2, 3,-2,-1, 1, 0, t) -
              z(2,-1, 3,-2,-1, 1, 0, t)   ) +
            ( z(1, 2, 3,-2,-3, 3, 0, t) -
              z(2,-1, 3,-2,-3, 3, 0, t)   ) -
            ( z(1, 2, 3, 3, 1, 0, 0, t) -
              z(2,-1, 3, 3, 1, 0, 0, t)   ) +
            ( z(2, 3, 1,-2, 2,-3, 3, t) -
              z(3,-2, 1,-2, 2,-3, 3, t)   ) -
            ( z(2, 3, 1,-1, 1, 0, 0, t) -
              z(3,-2, 1,-1, 1, 0, 0, t)   ) ) );
}

double TDI::zeta2(double t) {
    return( ( y(1,-3, 2, 2, 3, 1, t) -
              y(1, 2, 3,-3, 3, 1, t) +
              y(2,-1, 3,-3, 3, 1, t) ) -
            ( y(2, 3, 1, 1,-1,-3, t) -
              y(3,-2, 1, 1,-1,-3, t) +
              y(3, 1, 2,-2,-1,-3, t) ) -
            ( y(1,-3, 2, 2,-2, 0, t) -
              y(1, 2, 3,-3,-2, 0, t) +
              y(2,-1, 3,-3,-2, 0, t) ) +
            ( y(2, 3, 1, 1, 2, 0, t) -
              y(3,-2, 1, 1, 2, 0, t) +
              y(3, 1, 2,-2, 2, 0, t) ) +
      0.5*( ( z(1, 2, 3,-3, 3, 1, 0, t) -
              z(2,-1, 3,-3, 3, 1, 0, t)   ) -
            ( z(1, 2, 3,-3,-2, 0, 0, t) -
              z(2,-1, 3,-3,-2, 0, 0, t)   ) +
            ( z(1, 2, 3,-2, 1,-1,-3, t) -
              z(2,-1, 3,-2, 1,-1,-3, t)   ) -
            ( z(1, 2, 3,-2, 1, 2, 0, t) -
              z(2,-1, 3,-2, 1, 2, 0, t)   ) +
            ( z(2, 3, 1,-3, 3, 1, 2, t) -
              z(3,-2, 1,-3, 3, 1, 2, t)   ) -
            ( z(2, 3, 1,-3,-2, 2, 0, t) -
              z(3,-2, 1,-3,-2, 2, 0, t)   ) +
            ( z(2, 3, 1,-3,-1, 1, 0, t) -
              z(3,-2, 1,-3,-1, 1, 0, t)   ) -
            ( z(2, 3, 1, 1, 2, 0, 0, t) -
              z(3,-2, 1, 1, 2, 0, 0, t)   ) +
            ( z(3, 1, 2,-3, 3,-1, 1, t) -
              z(1,-3, 2,-3, 3,-1, 1, t)   ) -
            ( z(3, 1, 2,-2, 2, 0, 0, t) -
              z(1,-3, 2,-2, 2, 0, 0, t)   ) ) );
}

double TDI::zeta3(double t) {
    return( ( y(2,-1, 3, 3, 1, 2, t) -
              y(2, 3, 1,-1, 1, 2, t) +
              y(3,-2, 1,-1, 1, 2, t) ) -
            ( y(3, 1, 2, 2,-2,-1, t) -
              y(1,-3, 2, 2,-2,-1, t) +
              y(1, 2, 3,-3,-2,-1, t) ) -
            ( y(2,-1, 3, 3,-3, 0, t) -
              y(2, 3, 1,-1,-3, 0, t) +
              y(3,-2, 1,-1,-3, 0, t) ) +
            ( y(3, 1, 2, 2, 3, 0, t) -
              y(1,-3, 2, 2, 3, 0, t) +
              y(1, 2, 3,-3, 3, 0, t) ) +
      0.5*( ( z(2, 3, 1,-1, 1, 2, 0, t) -
              z(3,-2, 1,-1, 1, 2, 0, t)   ) -
            ( z(2, 3, 1,-1,-3, 0, 0, t) -
              z(3,-2, 1,-1,-3, 0, 0, t)   ) +
            ( z(2, 3, 1,-3, 2,-2,-1, t) -
              z(3,-2, 1,-3, 2,-2,-1, t)   ) -
            ( z(2, 3, 1,-3, 2, 3, 0, t) -
              z(3,-2, 1,-3, 2, 3, 0, t)   ) +
            ( z(3, 1, 2,-1, 1, 2, 3, t) -
              z(1,-3, 2,-1, 1, 2, 3, t)   ) -
            ( z(3, 1, 2,-1,-3, 3, 0, t) -
              z(1,-3, 2,-1,-3, 3, 0, t)   ) +
            ( z(3, 1, 2,-1,-2, 2, 0, t) -
              z(1,-3, 2,-1,-2, 2, 0, t)   ) -
            ( z(3, 1, 2, 2, 3, 0, 0, t) -
              z(1,-3, 2, 2, 3, 0, 0, t)   ) +
            ( z(1, 2, 3,-1, 1,-2, 2, t) -
              z(2,-1, 3,-1, 1,-2, 2, t)   ) -
            ( z(1, 2, 3,-3, 3, 0, 0, t) -
              z(2,-1, 3,-3, 3, 0, 0, t)   ) ) );
}

// in this expression the order of the delays is physically
// motivated, but the combination still does not cancel laser
// noise (from the final ref. lasers) in ModifiedLISA

double TDI::alpham(double t) {
    return( y(3,-2, 1, 0, 0, 0, t) -
            y(2, 3, 1, 0, 0, 0, t) +
            y(2,-1, 3,-2, 0, 0, t) -
            y(3, 1, 2, 3, 0, 0, t) +
            y(1,-3, 2,-1,-2, 0, t) -
            y(1, 2, 3, 1, 3, 0, t) +
    0.5 * ( z(2, 3, 1,-3,-1,-2, 0, t) -
            z(3,-2, 1, 2, 1, 3, 0, t) +
            z(3, 1, 2,-1,-2, 0, 0, t) -
            z(2,-1, 3, 1, 3, 0, 0, t) +
            z(1, 2, 3, 1, 3, 0, 0, t) -
            z(1,-3, 2,-1,-2, 0, 0, t) +
            z(3, 1, 2, 3, 0, 0, 0, t) -
            z(2,-1, 3,-2, 0, 0, 0, t) +
            z(1, 2, 3,-2, 0, 0, 0, t) -
            z(1,-3, 2, 3, 0, 0, 0, t) +
            z(2, 3, 1, 0, 0, 0, 0, t) -
            z(3,-2, 1, 0, 0, 0, 0, t) ) );
}

double TDI::betam(double t) {
    return( y(1,-3, 2, 0, 0, 0, t) -
            y(3, 1, 2, 0, 0, 0, t) +
            y(3,-2, 1,-3, 0, 0, t) -
            y(1, 2, 3, 1, 0, 0, t) +
            y(2,-1, 3,-2,-3, 0, t) -
            y(2, 3, 1, 2, 1, 0, t) +
    0.5 * ( z(3, 1, 2,-1,-2,-3, 0, t) -
            z(1,-3, 2, 3, 2, 1, 0, t) +
            z(1, 2, 3,-2,-3, 0, 0, t) -
            z(3,-2, 1, 2, 1, 0, 0, t) +
            z(2, 3, 1, 2, 1, 0, 0, t) -
            z(2,-1, 3,-2,-3, 0, 0, t) +
            z(1, 2, 3, 1, 0, 0, 0, t) -
            z(3,-2, 1,-3, 0, 0, 0, t) +
            z(2, 3, 1,-3, 0, 0, 0, t) -
            z(2,-1, 3, 1, 0, 0, 0, t) +
            z(3, 1, 2, 0, 0, 0, 0, t) -
            z(1,-3, 2, 0, 0, 0, 0, t) ) );
}

double TDI::gammam(double t) {
    return( y(2,-1, 3, 0, 0, 0, t) -
            y(1, 2, 3, 0, 0, 0, t) +
            y(1,-3, 2,-1, 0, 0, t) -
            y(2, 3, 1, 2, 0, 0, t) +
            y(3,-2, 1,-3,-1, 0, t) -
            y(3, 1, 2, 3, 2, 0, t) +
    0.5 * ( z(1, 2, 3,-2,-3,-1, 0, t) -
            z(2,-1, 3, 1, 3, 2, 0, t) +
            z(2, 3, 1,-3,-1, 0, 0, t) -
            z(1,-3, 2, 3, 2, 0, 0, t) +
            z(3, 1, 2, 3, 2, 0, 0, t) -
            z(3,-2, 1,-3,-1, 0, 0, t) +
            z(2, 3, 1, 2, 0, 0, 0, t) -
            z(1,-3, 2,-1, 0, 0, 0, t) +
            z(3, 1, 2,-1, 0, 0, 0, t) -
            z(3,-2, 1, 2, 0, 0, 0, t) +
            z(1, 2, 3, 0, 0, 0, 0, t) -
            z(2,-1, 3, 0, 0, 0, 0, t) ) );
}

double TDI::alpha1(double t) {
    return( y(1,-3, 2,-1,-2, 2, 1, 3, 0, 0, t) -
            y(1, 2, 3, 1, 3,-3,-1,-2, 0, 0, t) +
            y(2,-1, 3,-2, 2, 1, 3, 0, 0, 0, t) -
            y(3, 1, 2, 3,-3,-1,-2, 0, 0, 0, t) +
            y(3,-2, 1, 2, 1, 3, t) -
            y(2, 3, 1,-3,-1,-2, t) + 
            y(1, 2, 3, 1, 3, 0, t) - 
            y(1,-3, 2,-1,-2, 0, t) +
            y(3, 1, 2, 3, 0, 0, t) -
            y(2,-1, 3,-2, 0, 0, t) +
            y(2, 3, 1, 0, 0, 0, t) -
            y(3,-2, 1, 0, 0, 0, t) +
    0.5 * ( z(2, 3, 1,-3,-1,-2, 2, 1, 3, 0, 0, t) -
            z(3,-2, 1, 2, 1, 3,-3,-1,-2, 0, 0, t) +
            z(1, 2, 3, 1, 3,-3,-1,-2, 0, 0, 0, t) -
            z(1,-3, 2,-1,-2, 2, 1, 3, 0, 0, 0, t) +
            z(3, 1, 2,-1,-2, 2, 1, 3, 0, 0, 0, t) -
            z(2,-1, 3, 1, 3,-3,-1,-2, 0, 0, 0, t) +
            z(1, 2, 3,-2, 2, 1, 3, t) -
            z(2,-1, 3,-2, 2, 1, 3, t) +
            z(3, 1, 2, 3,-3,-1,-2, t) -
            z(1,-3, 2, 3,-3,-1,-2, t) +
            z(1,-3, 2,-1,-2, 0, 0, t) -
            z(3, 1, 2,-1,-2, 0, 0, t) +
            z(2,-1, 3, 1, 3, 0, 0, t) -
            z(1, 2, 3, 1, 3, 0, 0, t) +
            z(1,-3, 2, 3, 0, 0, 0, t) -
            z(1, 2, 3,-2, 0, 0, 0, t) +
            z(2,-1, 3,-2, 0, 0, 0, t) -
            z(3, 1, 2, 3, 0, 0, 0, t) +
            z(3,-2, 1, 0, 0, 0, 0, t) -
            z(2, 3, 1, 0, 0, 0, 0, t) ) );
}

double TDI::alpha2(double t) {
    return( y(2,-1, 3,-2,-3, 3, 2, 1, 0, 0, t) -
            y(2, 3, 1, 2, 1,-1,-2,-3, 0, 0, t) +
            y(3,-2, 1,-3, 3, 2, 1, 0, 0, 0, t) -
            y(1, 2, 3, 1,-1,-2,-3, 0, 0, 0, t) +
            y(1,-3, 2, 3, 2, 1, t) -
            y(3, 1, 2,-1,-2,-3, t) +
            y(2, 3, 1, 2, 1, 0, t) -
            y(2,-1, 3,-2,-3, 0, t) +
            y(1, 2, 3, 1, 0, 0, t) -
            y(3,-2, 1,-3, 0, 0, t) +
            y(3, 1, 2, 0, 0, 0, t) -
            y(1,-3, 2, 0, 0, 0, t) +
    0.5 * ( z(3, 1, 2,-1,-2,-3, 3, 2, 1, 0, 0, t) -
            z(1,-3, 2, 3, 2, 1,-1,-2,-3, 0, 0, t) +
            z(2, 3, 1, 2, 1,-1,-2,-3, 0, 0, 0, t) -
            z(2,-1, 3,-2,-3, 3, 2, 1, 0, 0, 0, t) +
            z(1, 2, 3,-2,-3, 3, 2, 1, 0, 0, 0, t) -
            z(3,-2, 1, 2, 1,-1,-2,-3, 0, 0, 0, t) +
            z(2, 3, 1,-3, 3, 2, 1, t) -
            z(3,-2, 1,-3, 3, 2, 1, t) +
            z(1, 2, 3, 1,-1,-2,-3, t) -
            z(2,-1, 3, 1,-1,-2,-3, t) +
            z(2,-1, 3,-2,-3, 0, 0, t) -
            z(1, 2, 3,-2,-3, 0, 0, t) +
            z(3,-2, 1, 2, 1, 0, 0, t) -
            z(2, 3, 1, 2, 1, 0, 0, t) +
            z(2,-1, 3, 1, 0, 0, 0, t) -
            z(2, 3, 1,-3, 0, 0, 0, t) +
            z(3,-2, 1,-3, 0, 0, 0, t) -
            z(1, 2, 3, 1, 0, 0, 0, t) +
            z(1,-3, 2, 0, 0, 0, 0, t) -
            z(3, 1, 2, 0, 0, 0, 0, t) ) );
}

double TDI::alpha3(double t) {
    return( y(3,-2, 1,-3,-1, 1, 3, 2, 0, 0, t) -
            y(3, 1, 2, 3, 2,-2,-3,-1, 0, 0, t) + 
            y(1,-3, 2,-1, 1, 3, 2, 0, 0, 0, t) -
            y(2, 3, 1, 2,-2,-3,-1, 0, 0, 0, t) +
            y(2,-1, 3, 1, 3, 2, t) -
            y(1, 2, 3,-2,-3,-1, t) +
            y(3, 1, 2, 3, 2, 0, t) -
            y(3,-2, 1,-3,-1, 0, t) +
            y(2, 3, 1, 2, 0, 0, t) -
            y(1,-3, 2,-1, 0, 0, t) +
            y(1, 2, 3, 0, 0, 0, t) -
            y(2,-1, 3, 0, 0, 0, t) +
    0.5 * ( z(1, 2, 3,-2,-3,-1, 1, 3, 2, 0, 0, t) -
            z(2,-1, 3, 1, 3, 2,-2,-3,-1, 0, 0, t) +
            z(3, 1, 2, 3, 2,-2,-3,-1, 0, 0, 0, t) -
            z(3,-2, 1,-3,-1, 1, 3, 2, 0, 0, 0, t) +
            z(2, 3, 1,-3,-1, 1, 3, 2, 0, 0, 0, t) -
            z(1,-3, 2, 3, 2,-2,-3,-1, 0, 0, 0, t) +
            z(3, 1, 2,-1, 1, 3, 2, t) -
            z(1,-3, 2,-1, 1, 3, 2, t) +
            z(2, 3, 1, 2,-2,-3,-1, t) -
            z(3,-2, 1, 2,-2,-3,-1, t) +
            z(3,-2, 1,-3,-1, 0, 0, t) -
            z(2, 3, 1,-3,-1, 0, 0, t) +
            z(1,-3, 2, 3, 2, 0, 0, t) -
            z(3, 1, 2, 3, 2, 0, 0, t) +
            z(3,-2, 1, 2, 0, 0, 0, t) -
            z(3, 1, 2,-1, 0, 0, 0, t) +
            z(1,-3, 2,-1, 0, 0, 0, t) -
            z(2, 3, 1, 2, 0, 0, 0, t) +
            z(2,-1, 3, 0, 0, 0, 0, t) -
            z(1, 2, 3, 0, 0, 0, 0, t) ) );
}

double TDI::P(double t) {
    return( y(1, 3, 2, 2, 0, 0, t) -
            y(1, 2, 3, 3, 0, 0, t) - 
            y(3, 1, 2, 2, 0, 0, t) +
            y(2, 1, 3, 3, 0, 0, t) +
            y(3, 1, 2, 1, 3, 0, t) -
            y(2, 1, 3, 1, 2, 0, t) + 
            y(1, 2, 3, 3, 1, 1, t) -
            y(1, 3, 2, 2, 1, 1, t) +
    0.5 * (-z(3, 2, 1, 2, 3, 0, 0, t) +
            z(3, 2, 1, 1, 1, 2, 3, t) + 
            z(2, 3, 1, 2, 3, 0, 0, t) -
            z(2, 3, 1, 1, 1, 2, 3, t) ) +
    0.5 * (-z(1, 3, 2, 2, 0, 0, 0, t) + 
            z(1, 3, 2, 1, 1, 2, 0, t) +
            z(3, 1, 2, 2, 0, 0, 0, t) -
            z(3, 1, 2, 1, 1, 2, 0, t) ) +
    0.5 * (-z(2, 1, 3, 3, 0, 0, 0, t) +
            z(2, 1, 3, 1, 1, 3, 0, t) +
            z(1, 2, 3, 3, 0, 0, 0, t) -
            z(1, 2, 3, 1, 1, 3, 0, t) ) );
}

double TDI::E(double t) {
    return( y(3, 1, 2, 2, 1, 0, t) -
            y(2, 1, 3, 3, 1, 0, t) -
            y(3, 1, 2, 3, 0, 0, t) +
            y(2, 1, 3, 2, 0, 0, t) +
            y(2, 3, 1, 1, 1, 0, t) -
            y(3, 2, 1, 1, 1, 0, t) -
            y(2, 3, 1, 0, 0, 0, t) +
            y(3, 2, 1, 0, 0, 0, t) -
    0.5 * ( z(2, 1, 3, 2, 0, 0, 0, t) +
            z(3, 2, 1, 0, 0, 0, 0, t) +
            z(1, 3, 2, 3, 0, 0, 0, t) -
            z(2, 1, 3, 1, 1, 2, 0, t) +
            z(1, 2, 3, 1, 1, 2, 0, t) -
            z(1, 3, 2, 1, 1, 3, 0, t) ) +
    0.5 * ( z(1, 2, 3, 2, 0, 0, 0, t) +
            z(2, 3, 1, 0, 0, 0, 0, t) +
            z(3, 1, 2, 3, 0, 0, 0, t) -
            z(3, 1, 2, 1, 1, 3, 0, t) +
            z(3, 2, 1, 1, 1, 0, 0, t) -
            z(2, 3, 1, 1, 1, 0, 0, t) ) );
};

double TDI::U(double t) {
    return( y(3, 2, 1, 1, 1, 3, t) -
            y(3, 2, 1, 3, 0, 0, t) -
            y(3, 1, 2, 1, 2, 3, t) +
            y(2, 1, 3, 1, 0, 0, t) -
            y(2, 1, 3, 2, 3, 0, t) +
            y(1, 3, 2, 1, 1, 0, t) -
            y(1, 3, 2, 0, 0, 0, t) +
            y(3, 1, 2, 0, 0, 0, t) -
    0.5 * ( z(2, 3, 1, 3, 0, 0, 0, t) +
            z(3, 1, 2, 0, 0, 0, 0, t) +
            z(1, 2, 3, 2, 3, 0, 0, t) +
            z(1, 3, 2, 1, 1, 0, 0, t) +
            z(2, 1, 3, 1, 1, 2, 3, t) +
            z(3, 2, 1, 1, 1, 3, 0, t) ) +
    0.5 * ( z(3, 2, 1, 3, 0, 0, 0, t) +
            z(1, 3, 2, 0, 0, 0, 0, t) +
            z(2, 1, 3, 2, 3, 0, 0, t) +
            z(3, 1, 2, 1, 1, 0, 0, t) +
            z(1, 2, 3, 1, 1, 2, 3, t) +
            z(2, 3, 1, 1, 1, 3, 0, t) ) );
};

double TDI::Xm(double t) {
    return( y(1,-3, 2, 3, 2,-2, t) -
            y(1, 2, 3,-2,-3, 3, t) +
            y(2, 3, 1, 2,-2, 0, t) -
            y(3,-2, 1,-3, 3, 0, t) +
            y(1, 2, 3,-2, 0, 0, t) -
            y(1,-3, 2, 3, 0, 0, t) + 
            y(3,-2, 1, 0, 0, 0, t) -
            y(2, 3, 1, 0, 0, 0, t) +
    0.5 * (-z(3,-2, 1, 2,-2,-3, 3, t) +
            z(3,-2, 1,-3, 3, 0, 0, t) +
            z(3,-2, 1, 2,-2, 0, 0, t) -
            z(3,-2, 1, 0, 0, 0, 0, t) ) +
    0.5 * ( z(2, 3, 1,-3, 3, 2,-2, t) -
            z(2, 3, 1,-3, 3, 0, 0, t) -
            z(2, 3, 1, 2,-2, 0, 0, t) +
            z(2, 3, 1, 0, 0, 0, 0, t) ) );
}

double TDI::Xmlock1(double t) {
    return( y(2, 3, 1, 2,-2, 0, t) -
            y(3,-2, 1,-3, 3, 0, t) +
            y(3,-2, 1, 0, 0, 0, t) -
            y(2, 3, 1, 0, 0, 0, t) );
}

double TDI::Xmlock2(double t) {
    return( y(1,-3, 2, 3, 2,-2, t) -
            y(1, 2, 3,-2,-3, 3, t) -
            y(3,-2, 1,-3, 3, 0, t) +
            y(1, 2, 3,-2, 0, 0, t) -
            y(1,-3, 2, 3, 0, 0, t) + 
            y(3,-2, 1, 0, 0, 0, t) );
}

double TDI::Xmlock3(double t) {
    return( y(1,-3, 2, 3, 2,-2, t) -
            y(1, 2, 3,-2,-3, 3, t) +
            y(2, 3, 1, 2,-2, 0, t) +
            y(1, 2, 3,-2, 0, 0, t) -
            y(1,-3, 2, 3, 0, 0, t) -
            y(2, 3, 1, 0, 0, 0, t) );
}

double TDI::Ym(double t) {
    return( y(2,-1, 3, 1, 3,-3, t)
           -y(2, 3, 1,-3,-1, 1, t)
           +y(3, 1, 2, 3,-3, 0, t)
           -y(1,-3, 2,-1, 1, 0, t)
           +y(2, 3, 1,-3, 0, 0, t)
           -y(2,-1, 3, 1, 0, 0, t)
           +y(1,-3, 2, 0, 0, 0, t)
           -y(3, 1, 2, 0, 0, 0, t) +
    0.5 * ( z(3, 1, 2,-1, 1, 3,-3, t)
           -z(3, 1, 2,-1, 1, 0, 0, t)
           -z(3, 1, 2, 3,-3, 0, 0, t)
           +z(3, 1, 2, 0, 0, 0, 0, t) ) +
    0.5 * (-z(1,-3, 2, 3,-3,-1, 1, t)
           +z(1,-3, 2,-1, 1, 0, 0, t)
           +z(1,-3, 2, 3,-3, 0, 0, t)
           -z(1,-3, 2, 0, 0, 0, 0, t) ) );
}

double TDI::Zm(double t) {
    return( y(3,-2, 1, 2, 1,-1, t)
           -y(3, 1, 2,-1,-2, 2, t)
           +y(1, 2, 3, 1,-1, 0, t)
           -y(2,-1, 3,-2, 2, 0, t)
           +y(3, 1, 2,-1, 0, 0, t)
           -y(3,-2, 1, 2, 0, 0, t)
           +y(2,-1, 3, 0, 0, 0, t) 
           -y(1, 2, 3, 0, 0, 0, t) +
    0.5 * (-z(2,-1, 3, 1,-1,-2, 2, t)
           +z(2,-1, 3, 1,-1, 0, 0, t)
           +z(2,-1, 3,-2, 2, 0, 0, t)
           -z(2,-1, 3, 0, 0, 0, 0, t) ) +
    0.5 * ( z(1, 2, 3,-2, 2, 1,-1, t)
           -z(1, 2, 3,-2, 2, 0, 0, t)
           -z(1, 2, 3, 1,-1, 0, 0, t)
           +z(1, 2, 3, 0, 0, 0, 0, t) ) );
}

double TDI::X1(double t) {
    return( y(1,-3, 2, 3, 2,-2, 2,-2,-3, 3, t) 
	   -y(1, 2, 3,-2,-3, 3,-3, 3, 2,-2, t) 
	   +y(2, 3, 1, 2,-2, 2,-2,-3, 3, 0, t) 
	   -y(3,-2, 1,-3, 3,-3, 3, 2,-2, 0, t) 
	   +y(1, 2, 3,-2, 2,-2,-3, 3, 0, 0, t) 
	   -y(1,-3, 2, 3,-3, 3, 2,-2, 0, 0, t) 
	   +y(3,-2, 1, 2,-2,-3, 3, 0, 0, 0, t)
	   -y(2, 3, 1,-3, 3, 2,-2, 0, 0, 0, t) 
	   +y(1, 2, 3,-2,-3, 3, t) 
	   -y(1,-3, 2, 3, 2,-2, t) 
	   +y(3,-2, 1,-3, 3, 0, t) 
	   -y(2, 3, 1, 2,-2, 0, t) 
	   +y(1,-3, 2, 3, 0, 0, t) 
	   -y(1, 2, 3,-2, 0, 0, t) 
	   +y(2, 3, 1, 0, 0, 0, t) 
	   -y(3,-2, 1, 0, 0, 0, t) +
    0.5 * ( z(2, 3, 1,-3, 3, 2,-2, 2,-2,-3, 3, t)
	   -z(2, 3, 1,-3, 3,-3, 3, 2,-2, 0, 0, t)
	   -z(2, 3, 1, 2,-2, 2,-2,-3, 3, 0, 0, t)
	   +z(2, 3, 1,-3, 3, 0, 0, t)
	   +z(2, 3, 1, 2,-2, 0, 0, t)
	   -z(2, 3, 1, 0, 0, 0, 0, t) ) +
    0.5 * (-z(3,-2, 1, 2,-2,-3, 3,-3, 3, 2,-2, t)
	   +z(3,-2, 1,-3, 3,-3, 3, 2,-2, 0, 0, t)
	   +z(3,-2, 1, 2,-2, 2,-2,-3, 3, 0, 0, t)
	   -z(3,-2, 1,-3, 3, 0, 0, t)
	   -z(3,-2, 1, 2,-2, 0, 0, t)
	   +z(3,-2, 1, 0, 0, 0, 0, t) ) );
}

double TDI::X2(double t) {
    return( y(2,-1, 3, 1, 3,-3, 3,-3,-1, 1, t) 
	   -y(2, 3, 1,-3,-1, 1,-1, 1, 3,-3, t) 
	   +y(3, 1, 2, 3,-3, 3,-3,-1, 1, 0, t) 
	   -y(1,-3, 2,-1, 1,-1, 1, 3,-3, 0, t) 
	   +y(2, 3, 1,-3, 3,-3,-1, 1, 0, 0, t) 
	   -y(2,-1, 3, 1,-1, 1, 3,-3, 0, 0, t) 
	   +y(1,-3, 2, 3,-3,-1, 1, 0, 0, 0, t)
	   -y(3, 1, 2,-1, 1, 3,-3, 0, 0, 0, t) 
	   +y(2, 3, 1,-3,-1, 1, t) 
	   -y(2,-1, 3, 1, 3,-3, t) 
	   +y(1,-3, 2,-1, 1, 0, t) 
	   -y(3, 1, 2, 3,-3, 0, t) 
	   +y(2,-1, 3, 1, 0, 0, t) 
	   -y(2, 3, 1,-3, 0, 0, t) 
	   +y(3, 1, 2, 0, 0, 0, t) 
	   -y(1,-3, 2, 0, 0, 0, t) +
    0.5 * ( z(3, 1, 2,-1, 1, 3,-3, 3,-3,-1, 1, t)
	   -z(3, 1, 2,-1, 1,-1, 1, 3,-3, 0, 0, t)
	   -z(3, 1, 2, 3,-3, 3,-3,-1, 1, 0, 0, t)
	   +z(3, 1, 2,-1, 1, 0, 0, t)
	   +z(3, 1, 2, 3,-3, 0, 0, t)
	   -z(3, 1, 2, 0, 0, 0, 0, t) ) +
    0.5 * (-z(1,-3, 2, 3,-3,-1, 1,-1, 1, 3,-3, t)
	   +z(1,-3, 2,-1, 1,-1, 1, 3,-3, 0, 0, t)
	   +z(1,-3, 2, 3,-3, 3,-3,-1, 1, 0, 0, t)
	   -z(1,-3, 2,-1, 1, 0, 0, t)
	   -z(1,-3, 2, 3,-3, 0, 0, t)
	   +z(1,-3, 2, 0, 0, 0, 0, t) ) );
}

double TDI::X3(double t) {
    return( y(3,-2, 1, 2, 1,-1, 1,-1,-2, 2, t) 
	   -y(3, 1, 2,-1,-2, 2,-2, 2, 1,-1, t) 
	   +y(1, 2, 3, 1,-1, 1,-1,-2, 2, 0, t) 
	   -y(2,-1, 3,-2, 2,-2, 2, 1,-1, 0, t) 
	   +y(3, 1, 2,-1, 1,-1,-2, 2, 0, 0, t) 
	   -y(3,-2, 1, 2,-2, 2, 1,-1, 0, 0, t) 
	   +y(2,-1, 3, 1,-1,-2, 2, 0, 0, 0, t)
	   -y(1, 2, 3,-2, 2, 1,-1, 0, 0, 0, t) 
	   +y(3, 1, 2,-1,-2, 2, t) 
	   -y(3,-2, 1, 2, 1,-1, t) 
	   +y(2,-1, 3,-2, 2, 0, t) 
	   -y(1, 2, 3, 1,-1, 0, t) 
	   +y(3,-2, 1, 2, 0, 0, t) 
	   -y(3, 1, 2,-1, 0, 0, t) 
	   +y(1, 2, 3, 0, 0, 0, t) 
	   -y(2,-1, 3, 0, 0, 0, t) +
    0.5 * ( z(1, 2, 3,-2, 2, 1,-1, 1,-1,-2, 2, t)
	   -z(1, 2, 3,-2, 2,-2, 2, 1,-1, 0, 0, t)
	   -z(1, 2, 3, 1,-1, 1,-1,-2, 2, 0, 0, t)
	   +z(1, 2, 3,-2, 2, 0, 0, t)
	   +z(1, 2, 3, 1,-1, 0, 0, t)
	   -z(1, 2, 3, 0, 0, 0, 0, t) ) +
    0.5 * (-z(2,-1, 3, 1,-1,-2, 2,-2, 2, 1,-1, t)
	   +z(2,-1, 3,-2, 2,-2, 2, 1,-1, 0, 0, t)
	   +z(2,-1, 3, 1,-1, 1,-1,-2, 2, 0, 0, t)
	   -z(2,-1, 3,-2, 2, 0, 0, t)
	   -z(2,-1, 3, 1,-1, 0, 0, t)
	   +z(2,-1, 3, 0, 0, 0, 0, t) ) );
}


SampledTDI::SampledTDI(LISA *l,Noise *yijk[6],Noise *zijk[6]) {
    // the convention is {12,21,23,32,31,13}

	lisa = l;

    for(int craft1 = 1; craft1 <= 3; craft1++) {
        for(int craft2 = 1; craft2 <= 3; craft2++) {
            if(craft1 != craft2) {
				if( (craft1 == 1 && craft2 == 2) || (craft1 == 2 && craft2 == 3) || (craft1 == 3 && craft2 == 1) ) {
		    		yobj[craft1][craft2] = yijk[2*(craft1-1)];
		    		zobj[craft1][craft2] = zijk[2*(craft1-1)];
		        } else {
		    	    yobj[craft1][craft2] = yijk[2*(craft2-1)+1];
		    	    zobj[craft1][craft2] = zijk[2*(craft2-1)+1];
		        }		        
	    	}
        }
    }
}

void SampledTDI::reset(unsigned long seed) {
    for(int craft1 = 1; craft1 <= 3; craft1++) {
        for(int craft2 = 1; craft2 <= 3; craft2++) {
            if(craft1 != craft2) {
                yobj[craft1][craft2]->reset();
                zobj[craft1][craft2]->reset();
            }
        }
    }
}

double SampledTDI::y(int send, int slink, int recv, int ret1, int ret2, int ret3, double t) {
    return y(send,slink,recv,ret1,ret2,ret3,0,0,0,0,t);
}

double SampledTDI::z(int send, int slink, int recv, int ret1, int ret2, int ret3, int ret4, double t) {
    return z(send,slink,recv,ret1,ret2,ret3,ret4,0,0,0,0,t);
}

// can improve precision by calling value with two times
// (assuming the underlying implementation supports it)

double SampledTDI::y(int send, int slink, int recv, int ret1, int ret2, int ret3, int ret4, int ret5, int ret6, int ret7, double t) {
    lisa->newretardtime(t);

    lisa->retard(ret7); lisa->retard(ret6); lisa->retard(ret5);
    lisa->retard(ret4); lisa->retard(ret3); lisa->retard(ret2); lisa->retard(ret1);

    return yobj[send][recv]->value(lisa->retardedtime());
}

double SampledTDI::z(int send, int slink, int recv, int ret1, int ret2, int ret3, int ret4, int ret5, int ret6, int ret7, int ret8, double t) {
    lisa->newretardtime(t);

    lisa->retard(ret8); lisa->retard(ret7); lisa->retard(ret6); lisa->retard(ret5);
    lisa->retard(ret4); lisa->retard(ret3); lisa->retard(ret2); lisa->retard(ret1);

    return zobj[send][recv]->value(lisa->retardedtime());
}
